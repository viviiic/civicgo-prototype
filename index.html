<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CivicGo ‰∫íÂãïÂéüÂûã (Á∞°ÂåñÁâà)</title>
    <!-- ËºâÂÖ• Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- ËºâÂÖ• Inter Â≠óÂûã --><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- ËºâÂÖ• Font Awesome ÂúñÁ§∫Â∫´ --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem;
            background-color: #E5E7EB; /* È†ÅÈù¢ËÉåÊôØËâ≤ */
        }
        /* Ê®°Êì¨ÊâãÊ©üÂ§ñÊ°Ü */
        .mobile-shell {
            width: 414px; 
            max-width: 100%; 
            aspect-ratio: 9 / 16; 
            max-height: 90vh; 
            border-radius: 2.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
            background-color: #f7fafc;
            display: flex;
            flex-direction: column;
        }
        .mobile-content {
             width: 100%;
             height: 100%;
             flex-grow: 1;
             display: flex;
             flex-direction: column;
             overflow: hidden; 
        }
        /* Ê®°Êì¨ LINE MINI App ÁöÑÈ†ÇÈÉ®Â∞éËà™Âàó */
        .mini-app-header {
            background-color: #ffffff;
            border-bottom: 1px solid #e2e8f0;
            flex-shrink: 0; 
        }
        /* Èö±Ëóè/È°ØÁ§∫Áï´Èù¢ÁöÑ class */
        .page {
            display: none; 
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            height: 100%; 
            flex-direction: column;
        }
        .page.active {
            display: flex; 
        }
        /* ‰ªªÂãôÂúñÈáòÁöÑÊ®£Âºè */
        .task-pin {
            position: absolute;
            transform: translate(-50%, -50%); 
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.8);
            border: 2px solid;
            backdrop-filter: blur(4px);
        }

        /* Êñ∞Â¢ûÔºö‰ªªÂãôÂü∑Ë°å‰∏≠Ê®ôÁ±§ */
        .task-label {
            display: none; /* È†êË®≠Èö±Ëóè */
            position: absolute;
            top: 100%; /* ÂúñÈáò‰∏ãÊñπ */
            left: 50%;
            transform: translateX(-50%);
            margin-top: 6px; /* ÂæÄ‰∏ãÊé® 6px */
            background-color: #16A34A; /* Á∂†Ëâ≤ */
            color: white;
            padding: 3px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            white-space: nowrap; /* Á¢∫‰øù "‰ªªÂãôÂü∑Ë°å‰∏≠" ‰∏çÊúÉÊèõË°å */
            z-index: 10; /* Á¢∫‰øùÂú®ÂÖ∂‰ªñÊù±Ë•ø‰πã‰∏ä */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .task-pin:hover {
            transform: translate(-50%, -50%) scale(1.1);
        }
        /* Êñ∞Â¢ûÔºö‰ªªÂãôÈÄ≤Ë°å‰∏≠ (ÈñÉÁàç) */
        .task-pin.active {
            /* ‰ΩøÁî® Tailwind ÁöÑ green-600: #16A34A */
            animation: pulse 1.5s infinite;
        }
        /* Êñ∞Â¢ûÔºöActive ÊôÇÈ°ØÁ§∫Ê®ôÁ±§ */
        .task-pin.active .task-label {
            display: block;
        }

        /* ËÜ†ÂõäÂºèÂàÜÈ†ÅÊåâÈàïÁöÑËΩâÂ†¥ÊïàÊûú */
        .tab-btn {
             transition: all 0.3s ease; /* ÁßªÈô§ @apply */
        }

        .tab-panel {
            display: none; /* È†êË®≠Èö±Ëóè */
        }
        .tab-panel.active {
            display: block; /* È°ØÁ§∫ÈÅ∏‰∏≠ÁöÑÂàÜÈ†Å */
        }
        
        /* Êñ∞Â¢ûÔºöÂÄã‰∫∫‰∏≠ÂøÉË®≠ÂÆöÈÄ£ÁµêÊ®£Âºè */
        .setting-link {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem; /* p-4 */
            background-color: white;
            border-bottom: 1px solid #f3f4f6; /* gray-100 */
            font-size: 1rem; /* text-base */
            color: #1f2937; /* gray-800 */
            font-weight: 500; /* medium */
        }
        .setting-link:hover {
            background-color: #f9fafb; /* gray-50 */
        }
        .setting-link > i {
            color: #9ca3af; /* gray-400 */
        }
        /* ÁßªÈô§ÊúÄÂæå‰∏ÄÂÄãÈÄ£ÁµêÁöÑÂ∫ïÁ∑ö */
        .setting-link:last-child {
            border-bottom: none;
        }


        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.7);
            }
            70% {
                box-shadow: 0 0 0 12px rgba(22, 163, 74, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(22, 163, 74, 0);
            }
        }
        /* Â∫ïÈÉ®ÂΩàÁ™ó */
        .bottom-sheet {
            animation: slide-up 0.3s ease-out;
        }
        @keyframes slide-up {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        /* ÂüéÂ∏ÇËä±ÂúíÁöÑËä±Êúµ */
        .flower {
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.5s ease-out;
        }
        .flower.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        /* Â∫ïÈÉ®Â∞éËà™ÂàóÊ®£Âºè */
        .bottom-nav {
            flex-shrink: 0; 
            height: 65px; 
            padding-top: 8px;
            padding-bottom: 8px;
        }
        
        /* Â∫ïÈÉ®Â∞éËà™ÊåâÈàï (Â∑¶Âè≥) - ‰øÆÊîπÁÇ∫ 5 ÂÄãÈ†ÖÁõÆ */
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 20%; /* 1/5 ÂØ¨Â∫¶ */
            padding-top: 0.25rem; /* pt-1 */
        }


        /* Ëä±ÂúíËÉåÊôØÊº∏ËÆä (Â§©Á©∫Ë™ø‰∫Æ) */
        .garden-bg-gradient {
            background: linear-gradient(to bottom, #ADD8E6, #C1E5F0); /* Ê∑∫ËóçËâ≤Â§©Á©∫Êº∏ËÆä (Êõ¥‰∫Æ) */
        }
    </style>
</head>
<body>

    <!-- Ê®°Êì¨ÊâãÊ©üÂ§ñÊ°Ü --><div class="mobile-shell">
        <div class="mobile-content"> 

            <!-- 
                ============================================================
                Áï´Èù¢ 1: ÂïüÂãïÁï´Èù¢ (Splash Screen) & LINE Login
                ============================================================
            --><div id="page-splash" class="page active bg-white items-center justify-center text-center p-8 space-y-8">
                <div class="flex flex-col items-center">
                    <i class="fa-solid fa-map-location-dot fa-4x text-green-500"></i>
                    <h1 class="text-3xl font-bold text-gray-800 mt-4">CivicGo</h1>
                    <p class="text-lg text-gray-600 mt-2">ËÆìÊîπËÆäÔºåÂæûÂ∑∑Âè£ÈñãÂßã</p>
                </div>
                
                <div class="w-full absolute bottom-16 left-0 px-8">
                    <!-- ‰øÆÊîπÔºöÁôªÂÖ•ÂæåÂâçÂæÄ‰∏ªÈ†Å -->
                    <button onclick="goToPage('page-home')" class="w-full bg-[#06C755] text-white font-semibold py-4 px-6 rounded-lg shadow-lg hover:bg-[#05b34b] transition-colors flex items-center justify-center space-x-2">
                        <i class="fa-brands fa-line fa-lg"></i>
                        <span>‰ΩøÁî® LINE ÁôªÂÖ•</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-4 text-center">ÁôªÂÖ•Âç≥Ë°®Á§∫ÊÇ®ÂêåÊÑèÊàëÂÄëÁöÑÊúçÂãôÊ¢ùÊ¨æ„ÄÇ</p>
                </div>
            </div>

            <!-- 
                ============================================================
                Áï´Èù¢ 2: ‰∏ªÁï´Èù¢ (Âú∞Âúñ‰ªªÂãô)
                ============================================================
            --><div id="page-map" class="page">
                <!-- Ê®°Êì¨ LINE MINI App È†ÇÈÉ® --><div class="mini-app-header w-full p-4 flex items-center justify-between shadow-sm">
                    <h1 class="text-xl font-bold text-gray-800">CivicGo</h1>
                    <!-- Âè≥‰∏äËßíÊåâÈàïÂ∑≤ÁßªÈô§ -->
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶‰øùÊåÅÊ®ôÈ°åÁΩÆ‰∏≠ -->
                </div>
                
                <!-- Âú∞ÂúñÂçÄÂüü - ‰ΩøÁî® SVG Á§∫ÊÑèÂúñ --><div class="flex-grow relative w-full overflow-hidden bg-gray-200">
                    <svg class="w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 600">
                        <!-- Âü∫Á§éÂ∫ïËâ≤ (Ê∑∫Á±≥Ëâ≤) --><rect x="0" y="0" width="400" height="600" fill="#F5F3EF" />
                        
                        <!-- ÈÅìË∑Ø (‰∏≠ÁÅ∞Ëâ≤) --><rect x="150" y="0" width="60" height="600" fill="#CBD5E1" /> <!-- ÂûÇÁõ¥‰∏ªË¶ÅÈÅìË∑Ø --><rect x="0" y="250" width="400" height="60" fill="#CBD5E1" /> <!-- Ê∞¥Âπ≥‰∏ªË¶ÅÈÅìË∑Ø --><rect x="0" y="450" width="400" height="40" fill="#E2E8F0" /> <!-- Ê∞¥Âπ≥Â∞èË∑Ø --><rect x="300" y="0" width="40" height="250" fill="#E2E8F0" /> <!-- ÂûÇÁõ¥Â∞èË∑Ø --><!-- ÈÅìË∑Ø‰∏≠ÂøÉÁ∑ö --><path d="M 170 0 V 600" stroke="#FFFFFF" stroke-width="2" stroke-dasharray="10 10" fill="none"/>
                        <path d="M 190 0 V 600" stroke="#FFFFFF" stroke-width="2" stroke-dasharray="10 10" fill="none"/>
                        <path d="M 0 270 H 400" stroke="#FFFFFF" stroke-width="2" stroke-dasharray="10 10" fill="none"/>
                        <path d="M 0 290 H 400" stroke="#FFFFFF" stroke-width="2" stroke-dasharray="10 10" fill="none"/>

                        <!-- Á∂†Âú∞ (ÂÖ¨Âúí) --><rect x="230" y="330" width="150" height="100" fill="#C6F6D5" /> <!-- Âè≥‰∏ãÂÖ¨Âúí --><rect x="20" y="20" width="110" height="210" fill="#D1FAE5" /> <!-- Â∑¶‰∏äÂÖ¨Âúí --><!-- Âª∫ÁØâÁâ© (Ê∑±ÁÅ∞ & ‰∏çÂêåËâ≤Ë™ø) --><rect x="230" y="20" width="50" height="80" fill="#9CA3AF" />
                        <rect x="230" y="120" width="50" height="110" fill="#A0AEC0" />
                        
                        <rect x="360" y="20" width="20" height="210" fill="#A0AEC0" />

                        <rect x="20" y="330" width="110" height="100" fill="#9CA3AF" />
                        <rect x="20" y="510" width="110" height="70" fill="#A0AEC0" />
                        <rect x="230" y="510" width="150" height="70" fill="#9CA3AF" />
                        
                        <!-- ÂÖ¨ÂúíË£°ÁöÑÊ®π (ÂúìÂΩ¢) --><circle cx="50" cy="50" r="10" fill="#4ADE80" opacity="0.8"/>
                        <circle cx="80" cy="80" r="15" fill="#34D399" opacity="0.8"/>
                        <circle cx="100" cy="150" r="12" fill="#4ADE80" opacity="0.8"/>
                        <circle cx="40" cy="200" r="10" fill="#34D399" opacity="0.8"/>
                        <circle cx="250" cy="360" r="10" fill="#4ADE80" opacity="0.8"/>
                        <circle cx="280" cy="400" r="15" fill="#34D399" opacity="0.8"/>
                        <circle cx="340" cy="380" r="12" fill="#4ADE80" opacity="0.8"/>
                    </svg>
                    
                    <!-- ‰ΩøÁî®ËÄÖÁï∂Ââç‰ΩçÁΩÆ --><div class="absolute" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div class="w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-md"></div>
                        <div class="w-4 h-4 bg-blue-500 rounded-full absolute top-0 left-0 animate-ping"></div>
                    </div>

                    <!-- ‰ªªÂãôÂúñÈáò 1: ÊíøÂûÉÂúæ --><div id="pin-task1" class="task-pin border-red-500" style="top: 45%; left: 40%;" onclick="showTaskDetail('task1')">
                        <i class="fa-solid fa-trash-can fa-lg text-red-700"></i>
                        <span class="task-label">‰ªªÂãôÂü∑Ë°å‰∏≠</span>
                    </div>

                    <!-- ‰ªªÂãôÂúñÈáò 2: Êçê‰∫åÊâãÊõ∏ --><div id="pin-task2" class="task-pin border-blue-500" style="top: 60%; left: 65%;" onclick="showTaskDetail('task2')">
                        <i class="fa-solid fa-book fa-lg text-blue-700"></i>
                        <span class="task-label">‰ªªÂãôÂü∑Ë°å‰∏≠</span>
                    </div>

                    <!-- ‰ªªÂãôÂúñÈáò 3: ÂãüÈõÜÂÜ¨Ë°£ --><div id="pin-task3" class="task-pin border-yellow-500" style="top: 25%; left: 55%;" onclick="showTaskDetail('task3')">
                        <i class="fa-solid fa-shirt fa-lg text-yellow-700"></i>
                        <span class="task-label">‰ªªÂãôÂü∑Ë°å‰∏≠</span>
                    </div>

                    <!-- Êñ∞Â¢ûÔºöÁôºÂ∏ÉÈúÄÊ±Ç (FAB) --><button onclick="goToPage('page-community-post')" class="absolute bottom-6 right-6 w-16 h-16 bg-green-500 text-white rounded-full flex items-center justify-center shadow-lg z-20">
                        <i class="fa-solid fa-plus fa-2x"></i>
                    </button>
                </div>
                
                <!-- Â∫ïÈÉ®Â∞éËà™ (ÂÖ®Êñ∞ 5 È†ÖÁõÆÁµêÊßã) --><div class="bottom-nav w-full bg-white flex justify-around items-center border-t border-gray-200 shadow-inner-top">
                    <!-- 1. ‰∏ªÈ†Å -->
                    <button onclick="goToPage('page-home')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-house"></i>
                        <span class="text-xs mt-1">‰∏ªÈ†Å</span>
                    </button>
                    <!-- 2. Á§æÁæ§ -->
                    <button onclick="goToPage('page-community-feed')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-users"></i>
                        <span class="text-xs mt-1">Á§æÁæ§</span>
                    </button>
                    <!-- 3. Âú∞Âúñ (Áï∂ÂâçÈ†Å) -->
                    <button onclick="goToPage('page-map')" class="bottom-nav-item text-green-600">
                        <i class="fa-solid fa-map-location-dot"></i>
                        <span class="text-xs font-semibold mt-1">Âú∞Âúñ</span>
                    </button>
                    <!-- 4. ÁçéÂãµ -->
                    <button onclick="goToPage('page-rewards')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-gift"></i>
                        <span class="text-xs mt-1">ÁçéÂãµ</span>
                    </button>
                    <!-- 5. ÂÄã‰∫∫ -->
                    <button onclick="goToPage('page-garden')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-user"></i>
                        <span class="text-xs mt-1">ÂÄã‰∫∫</span>
                    </button>
                </div>
            </div>

            <!-- 
                ============================================================
                Áï´Èù¢ 3: ‰ªªÂãôË©≥ÊÉÖ (Â∫ïÈÉ®ÂΩàÁ™ó)
                ============================================================
            --><div id="modal-task-detail" class="page" style="display: none; background-color: rgba(0,0,0,0.5);" onclick="closeModal('modal-task-detail')">
                <div class="w-full bg-white rounded-t-2xl p-6 absolute bottom-0 bottom-sheet max-h-[70%] flex flex-col" onclick="event.stopPropagation()">
                    <div id="task-detail-content" class="overflow-y-auto"></div>
                    <div class="mt-6 flex space-x-4 flex-shrink-0">
                        <button onclick="closeModal('modal-task-detail')" class="w-1/3 bg-gray-200 text-gray-700 font-semibold py-3 rounded-lg">ÂÜçÁúãÁúã</button>
                        <button id="accept-task-btn" class="w-2/3 bg-green-500 text-white font-semibold py-3 rounded-lg shadow-lg hover:bg-green-600 transition-colors">
                            Êé•Âèó‰ªªÂãô
                        </button>
                    </div>
                </div>
            </div>

            <!-- 
                ============================================================
                Áï´Èù¢ 4: ‰ªªÂãôÈ©óË≠â (Ê®°Êì¨Áõ∏Ê©ü)
                ============================================================
            --><div id="page-validation" class="page bg-gray-900 items-center justify-center text-white p-4">
                
                <!-- È©óË≠â‰∏≠ËÆÄÂèñÁï´Èù¢ --><div id="ai-verifying" class="absolute inset-0 bg-gray-900/90 backdrop-blur-sm flex-col items-center justify-center" style="display: none; z-index: 20;">
                    <p class="mt-4 text-gray-200 font-semibold text-lg">üì∏ Ê≠£Âú®È©óË≠âÊÇ®ÁöÑË≤¢Áçª...</p>
                </div>

                <!-- ÊãçÁÖß‰ªãÈù¢ --><div class="w-full text-center absolute top-16">
                    <h2 class="text-2xl font-semibold">‰ªªÂãôÈ©óË≠â</h2>
                    <p id="validation-instruction" class="text-lg text-gray-300 mt-2">Ë´ãÊãçÊîùÊÇ®Êî∂ÈõÜÁöÑÂûÉÂúæË¢ã</p>
                </div>
                
                <div class="w-full aspect-square bg-gray-700 rounded-lg flex items-center justify-center text-gray-500">
                    <i class="fa-solid fa-camera fa-7x"></i>
                </div>

                <div class="w-full absolute bottom-16 left-0 px-8 flex justify-around items-center">
                    <button onclick="goToPage('page-map')" class="text-white font-medium">ÂèñÊ∂à</button>
                    <button onclick="startAIVerification()" class="w-20 h-20 bg-white rounded-full border-4 border-gray-300 shadow-xl"></button>
                    <button class="text-white font-medium opacity-0">ÂàáÊèõ</button>
                </div>
            </div>

            <!-- 
                ============================================================
                Áï´Èù¢ 5: ‰ªªÂãôÊàêÂäü - ÂàÜ‰∫´Ëá≥ VOOM
                ============================================================
            --><div id="page-success" class="page bg-white items-center text-center p-8 pt-24 space-y-6">
                <i class="fa-solid fa-circle-check fa-7x text-green-500"></i>
                
                <h1 class="text-3xl font-bold text-gray-800">‰ªªÂãôÂÆåÊàêÔºÅ</h1>
                <p class="text-lg text-gray-600">ÊÅ≠ÂñúÔºÅÊÇ®Áç≤Âæó‰∫Ü <span id="reward-points" class="font-bold text-green-600"></span> ÈªûÁ©çÂàÜ„ÄÇ</p>
                <!-- ÁßªÈô§‰∫ÜÈáçÁñäÁöÑÂúñÁâáÔºå‰øùÁïôÊñáÂ≠ó --><p class="text-lg font-semibold text-gray-700">ÊÇ®ÁöÑ„ÄåÂüéÂ∏ÇËä±Âúí„ÄçÈï∑Âá∫‰∫Ü‰∏ÄÊúµÊñ∞ÁöÑËä±ÔºÅ</p>
                
                <div class="w-full absolute bottom-16 left-0 px-8 space-y-4">
                    <button onclick="goToPage('page-garden')" class="w-full bg-green-500 text-white font-semibold py-4 px-6 rounded-lg shadow-lg hover:bg-green-600 transition-colors">
                        Êü•ÁúãÊàëÁöÑËä±Âúí
                    </button>
                    <button onclick="showSimpleAlert('Â∑≤ÂàÜ‰∫´Ëá≥ LINE VOOM (Ê®°Êì¨)')" class="w-full bg-white text-[#06C755] border-2 border-[#06C755] font-semibold py-3 px-6 rounded-lg flex items-center justify-center space-x-2">
                        <i class="fa-brands fa-line fa-lg"></i>
                        <span>ÂàÜ‰∫´Ëá≥ LINE VOOM</span>
                    </button>
                    <button onclick="goToPage('page-map')" class="w-full bg-gray-100 text-gray-700 font-semibold py-3 px-6 rounded-lg">
                        Â∞ãÊâæ‰∏ã‰∏ÄÂÄã‰ªªÂãô
                    </button>
                </div>
            </div>
            
            <!-- 
                ============================================================
                Áï´Èù¢ 6: ÂÄã‰∫∫‰∏≠ÂøÉ (page-garden) - Ê†πÊìö‰ºÅÂäÉÊõ∏‰øÆÊ≠£
                ============================================================
            --><div id="page-garden" class="page bg-gray-50">
                <!-- È†ÇÈÉ®Â∞éËà™ (‰ªøÊà™Âúñ) --><div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <div class="flex items-center space-x-3">
                        <img src="https://placehold.co/40x40/c6f6d5/2f855a?text=You" alt="Your Avatar" class="w-10 h-10 rounded-full">
                        <h1 class="text-lg font-bold text-gray-800">Hi, NCUEfreshman</h1>
                    </div>
                </div>

                <!-- ÂèØÊç≤ÂãïÁöÑ wrapper --><div class="flex-grow overflow-y-auto"> <!-- ÁßªÈô§ p-6 Âíå space-y-6 -->

                    <!-- ‰øÆÊ≠£ÔºöCivicGo ÂõõÊ†ºÁµ±Ë®àÁâà --><div class="bg-white rounded-lg shadow-lg p-4 m-4">
                        <div class="grid grid-cols-4 gap-2 text-center"> <!-- 4 Ê¨Ñ -->
                            <!-- Á∏ΩÁ©çÂàÜ -->
                            <div class="p-2">
                                <p class="text-3xl font-bold text-green-600" id="garden-total-points">0</p>
                                <p class="text-sm text-gray-500">Á∏ΩÁ©çÂàÜ</p>
                            </div>
                            <!-- ÂÆåÊàê‰ªªÂãô -->
                            <div class="p-2">
                                <p class="text-3xl font-bold text-gray-800" id="garden-tasks-completed">0</p>
                                <p class="text-sm text-gray-500">ÂÆåÊàê‰ªªÂãô</p>
                            </div>
                            <!-- ‰ø°Áî®Á©çÂàÜ -->
                            <div class="p-2">
                                <p class="text-3xl font-bold text-blue-600" id="garden-trust-score">100</p>
                                <p class="text-sm text-gray-500">‰ø°Áî®Á©çÂàÜ</p>
                            </div>
                            <!-- Â∑≤ÈÇÄË´ã -->
                            <div class="p-2">
                                <p class="text-3xl font-bold text-gray-800">0</p>
                                <p class="text-sm text-gray-500">Â∑≤ÈÇÄË´ã</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ê†∏ÂøÉÔºöÂüéÂ∏ÇËä±Âúí (Âä†Âõû‰æÜ) --><div class="p-6 pt-0 flex flex-col items-center justify-center bg-green-50 rounded-2xl m-4 shadow-inner">
                        <p class="w-full text-center text-lg font-semibold text-gray-700 mb-4 mt-6">NCUEfreshmanÁöÑËä±Âúí</p>
                        <div class="w-full h-64 rounded-lg flex items-end justify-center space-x-4 overflow-hidden relative p-4 garden-bg-gradient">
                            
                            <svg class="absolute bottom-0 left-0 w-full h-32 z-20" viewBox="0 0 400 128" preserveAspectRatio="none" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <!-- Ê∑∫Ëâ≤ËçâÂú∞ (ÂâçÊôØ) --><rect x="0" y="48" width="400" height="80" fill="#22C55E"/>
                                <!-- Ê∑±Ëâ≤ËçâÂú∞ (ËÉåÊôØ) Á®çÈ´ò‰∏ÄÈªû --><rect x="0" y="0" width="400" height="80" fill="#15803D" opacity="0.8"/>
                            </svg>

                            <div id="flower-container" class="relative z-30 flex items-end h-full w-full justify-around"> 
                                <!-- Ëä±ÊúµÊúÉË¢´ JS Âä†Âà∞ÈÄôË£° --></div>
                        </div>
                    </div>
                    
                    <!-- ‰øÆÊ≠£ÔºöË®≠ÂÆöÈÄ£ÁµêÂàóË°® -->
                    <div class="bg-white rounded-lg shadow-lg m-4 overflow-hidden">
                        <button onclick="goToPage('page-impact')" class="setting-link w-full text-left">
                            <span>ÊàëÁöÑÂΩ±ÈüøÂäõ</span>
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                        <button onclick="goToPage('page-partners')" class="setting-link w-full text-left">
                            <span>Âêà‰Ωú NPO ËàáÁ§æÂçÄ</span>
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                        <button onclick="goToPage('page-csr')" class="setting-link w-full text-left">
                            <span>ÂèÉËàá‰ºÅÊ•≠Á§æÊúÉË≤¨‰ªª</span>
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                        <button onclick="goToPage('page-contact')" class="setting-link w-full text-left">
                            <span>ËÅØÁµ°ÊàëÂÄë</span>
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                        <button onclick="goToPage('page-about')" class="setting-link w-full text-left">
                            <span>ÈóúÊñº CivicGo App</span>
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                        <button onclick="goToPage('page-splash')" class="setting-link w-full text-left text-red-600">
                            <span>ÁôªÂá∫</span>
                            <i class="fa-solid fa-arrow-right-from-bracket"></i>
                        </button>
                    </div>

                </div> <!-- ÁµêÊùüÂèØÊç≤ÂãïÁöÑ wrapper -->
                
                <!-- Â∫ïÈÉ®Â∞éËà™ (ÂÖ®Êñ∞ 5 È†ÖÁõÆÁµêÊßã) --><div class="bottom-nav w-full bg-white flex justify-around items-center border-t border-gray-200 shadow-inner-top"> <!-- ÁßªÈô§ fixed Âíå style -->
                    <!-- 1. ‰∏ªÈ†Å -->
                    <button onclick="goToPage('page-home')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-house"></i>
                        <span class="text-xs mt-1">‰∏ªÈ†Å</span>
                    </button>
                    <!-- 2. Á§æÁæ§ -->
                    <button onclick="goToPage('page-community-feed')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-users"></i>
                        <span class="text-xs mt-1">Á§æÁæ§</span>
                    </button>
                    <!-- 3. Âú∞Âúñ -->
                    <button onclick="goToPage('page-map')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-map-location-dot"></i>
                        <span class="text-xs mt-1">Âú∞Âúñ</span>
                    </button>
                    <!-- 4. ÁçéÂãµ -->
                    <button onclick="goToPage('page-rewards')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-gift"></i>
                        <span class="text-xs mt-1">ÁçéÂãµ</span>
                    </button>
                    <!-- 5. ÂÄã‰∫∫ (Áï∂ÂâçÈ†Å) -->
                    <button onclick="goToPage('page-garden')" class="bottom-nav-item text-green-600">
                        <i class="fa-solid fa-user"></i>
                        <span class="text-xs font-semibold mt-1">ÂÄã‰∫∫</span>
                    </button>
                </div>
            </div>

            <!-- 
                ============================================================
                Áï´Èù¢ 7: Á§æÂçÄÁ´Ø (ÁôºÂ∏ÉÈúÄÊ±Ç) - ÊîπÁÇ∫Â≠êÈ†ÅÈù¢
                ============================================================
            --><div id="page-community-post" class="page"> 
                
                <div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <!-- Êñ∞Â¢ûÔºöËøîÂõûÊåâÈàï -->
                    <button onclick="goToPage('page-map')" class="p-2 text-gray-600">
                        <i class="fa-solid fa-chevron-left fa-lg"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-grow">ÁôºÂ∏ÉÁ§æÂçÄÈúÄÊ±Ç</h1>
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶‰øùÊåÅÊ®ôÈ°åÁΩÆ‰∏≠ -->
                </div>

                <div class="flex-grow overflow-y-auto p-6"> 

                    <!-- Ê≠•È©ü 2 ÊîπÁÇ∫È†êË®≠È°ØÁ§∫ --><div id="manual-form-step">
                        <form onsubmit="event.preventDefault(); showCommunitySuccess();">
                                <div class="space-y-4">
                                    <div>
                                        <label for="task-title" class="text-sm font-medium text-gray-700">‰ªªÂãôÊ®ôÈ°å</label>
                                        <input type="text" id="task-title" class="w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="‰æãÂ¶ÇÔºö‚ú® ÈÄ±Êú´Ê∑®ÁÅòÁ•ûÈöäÂèãÂãüÈõÜÔºÅ">
                                    </div>
                                    <div>
                                        <label for="task-description" class="text-sm font-medium text-gray-700">‰ªªÂãôÊèèËø∞</label>
                                        <textarea id="task-description" rows="4" class="w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="‰æãÂ¶ÇÔºöÊàëÂÄëÈúÄË¶Å 5 ‰ΩçÂ§•‰º¥ÔºåÂçîÂä©Ê∏ÖÁêÜÊµ∑ÁÅò..."></textarea>
                                    </div>
                                    <div class="flex space-x-4">
                                        <div class="w-1/2">
                                            <label for="task-location" class="text-sm font-medium text-gray-700">‰ªªÂãôÂú∞Èªû</label>
                                            <input type="text" id="task-location" class="w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="‰æãÂ¶ÇÔºöÈÄ≤Âæ∑Ë∑ØÂÆâÂÖ®Â≥∂">
                                        </div>
                                        <div class="w-1/2">
                                            <label for="task-time" class="text-sm font-medium text-gray-700">Êó•ÊúüÊôÇÈñì</label>
                                            <input type="text" id="task-time" class="w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="‰æãÂ¶ÇÔºö11/20 ‰∏ãÂçà2Èªû">
                                        </div>
                                    </div>
                                    <div class="flex space-x-4">
                                        <div class="w-1/2">
                                            <label for="task-people" class="text-sm font-medium text-gray-700">ÈúÄÊ±Ç‰∫∫Êï∏</label>
                                            <input type="number" id="task-people" class="w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="‰æãÂ¶ÇÔºö5">
                                        </div>
                                        <div class="w-1/2">
                                            <label for="task-reward" class="text-sm font-medium text-gray-700">ÁçéÂãµÁ©çÂàÜ</gabel>
                                            <input type="number" id="task-reward" class="w-full mt-1 p-2 border border-gray-300 rounded-lg" placeholder="‰æãÂ¶ÇÔºö50">
                                        </div>
                                    </div>
                                    
                                    <button type="submit" class="w-full bg-green-500 text-white font-semibold py-3 rounded-lg shadow-lg hover:bg-green-600 transition-colors">
                                        Á¢∫Ë™çÁôºÂ∏É
                                    </button>
                                </div>
                            </form>
                        </div>
                </div> 
                
                <!-- ÁßªÈô§‰∫ÜÊ≠§È†ÅÁöÑÂ∫ïÈÉ®Â∞éËà™ -->

            </div>
            
            <!-- 
                ============================================================
                Áï´Èù¢ 8: Á§æÂçÄË≤¢ÁçªÊéíË°åÊ¶ú (Ê≠§È†ÅÈù¢Â∑≤Âêà‰ΩµÂà∞ "Á§æÁæ§")
                ============================================================
            -->
            <!-- ËàäÁöÑ page-ranking Êï¥ÂÄã div Â∑≤Ë¢´ÁßªÈô§ -->

            <!-- 
                ============================================================
                Êñ∞Â¢ûÁï´Èù¢ 8: Á§æÁæ§ (ÂãïÊÖã + ÊéíË°åÊ¶ú) - Êñ∞Â¢û‰∫íÂãï
                ============================================================
            --><div id="page-community-feed" class="page bg-gray-50">
                <!-- „Äê‰øÆÊîπ„ÄëÈ†ÇÈÉ®Â∞éËà™ (Ê®ôÈ°å + ËÜ†ÂõäÊåâÈàï) --><div class="mini-app-header w-full p-4 flex flex-col shadow-sm">
                    <h1 class="text-xl font-bold text-gray-800 text-center w-full">Á§æÁæ§</h1>
                    <!-- Êñ∞ÔºöËÜ†ÂõäÂºèÂàÜÈ†ÅÂàáÊèõ -->
                    <div class="w-full max-w-sm mx-auto bg-gray-100 p-1.5 rounded-full flex justify-center mt-4">
                        <button id="tab-btn-feed" class="tab-btn w-1/2 py-2 rounded-full text-center font-semibold bg-white text-green-600 shadow-md" onclick="showTab('feed')">
                            <i class="fa-solid fa-images mr-1"></i> ÂãïÊÖã
                        </button>
                        <button id="tab-btn-ranking" class="tab-btn w-1/2 py-2 rounded-full text-center font-semibold text-gray-600" onclick="showTab('ranking')">
                            <i class="fa-solid fa-chart-simple mr-1"></i> ÊéíË°åÊ¶ú
                        </button>
                    </div>
                </div>

                <!-- ÂèØÊç≤ÂãïÂÖßÂÆπÂçÄ -->
                <div class="flex-grow overflow-y-auto"> <!-- ÁßªÈô§ pb-16 -->
                    <!-- ÂàÜÈ†Å 1: ÂãïÊÖã (Êñ∞ÂäüËÉΩ) -->
                    <div id="tab-panel-feed" class="tab-panel active p-4 space-y-4">
                        
                        <!-- Êñ∞Â¢ûÔºöÁôºÂ∏ÉÂãïÊÖã -->
                        <div class="bg-white rounded-lg shadow p-4">
                            <textarea id="new-post-content" class="w-full p-2 border border-gray-200 rounded-lg text-sm" rows="3" placeholder="ÂàÜ‰∫´ÊÇ®‰ªäÂ§©ÂÅö‰∫Ü‰ªÄÈ∫º..."></textarea>
                            <button onclick="addNewPost()" class="w-full mt-2 bg-green-500 text-white font-semibold py-2 rounded-lg hover:bg-green-600 transition-colors">
                                ÁôºÂ∏ÉÂãïÊÖã
                            </button>
                        </div>

                        <!-- ÂãïÊÖãÁâÜÂÆπÂô® -->
                        <div id="feed-post-container" class="space-y-4">
                            <!-- ÁØÑ‰æãË≤ºÊñá 1 -->
                            <div class="bg-white rounded-lg shadow p-4">
                                <div class="flex items-center space-x-3 mb-3">
                                    <img src="https://placehold.co/40x40/fecdd3/881337?text=C" alt="Avatar" class="w-10 h-10 rounded-full">
                                    <div>
                                        <p class="font-semibold text-gray-800">CivicLover123</p>
                                        <p class="text-xs text-gray-500">2 Â∞èÊôÇÂâç</p>
                                    </div>
                                </div>
                                <p class="text-gray-700 mb-3">‰ªäÂ§©ÂéªÈÄ≤Âæ∑Ë∑ØÂπ´ÂøôÊíøÂûÉÂúæ‰∫ÜÔºÅÈõñÁÑ∂ÂæàÁÜ±Ôºå‰ΩÜÁúãÂà∞Ë°óÈÅìËÆä‰πæÊ∑®Â∞±Â•ΩÈñãÂøÉÔºÅü•≥ #CivicGo #Á§æÂçÄÊúçÂãô</p>
                                <img src="https://placehold.co/400x250/c6f6d5/2f855a?text=Cleaned+Street" alt="Ë≤ºÊñáÂúñÁâá" class="w-full rounded-lg object-cover">
                                <!-- Êñ∞Â¢ûÔºö‰∫íÂãïÊåâÈàï -->
                                <div class="flex items-center space-x-4 mt-3 pt-3 border-t border-gray-100">
                                    <button class="flex items-center space-x-1 text-gray-600 hover:text-red-500" onclick="toggleLike(this)">
                                        <i class="fa-regular fa-heart"></i>
                                        <span class="text-sm font-medium">12</span>
                                    </button>
                                    <button class="flex items-center space-x-1 text-gray-600 hover:text-blue-500" onclick="showSimpleAlert('ÁïôË®ÄÂäüËÉΩÈñãÁôº‰∏≠ÔºÅ')">
                                        <i class="fa-regular fa-comment"></i>
                                        <span class="text-sm font-medium">3</span>
                                    </button>
                                </div>
                            </div>
                            <!-- ÁØÑ‰æãË≤ºÊñá 2 -->
                            <div class="bg-white rounded-lg shadow p-4">
                                <div class="flex items-center space-x-3 mb-3">
                                    <img src="https://placehold.co/40x40/dbeafe/1e40af?text=G" alt="Avatar" class="w-10 h-10 rounded-full">
                                    <div>
                                        <p class="font-semibold text-gray-800">GreenGuardian8</p>
                                        <p class="text-xs text-gray-500">5 Â∞èÊôÇÂâç</p>
                                    </div>
                                </div>
                                <p class="text-gray-700">ÊääÂÆ∂Ë£°Áî®‰∏çÂà∞ÁöÑ‰∫åÊâãÊõ∏ÊçêÁµ¶ÂúñÊõ∏È§®‰∫ÜÔºåÂ∏åÊúõËÉΩÂπ´Âà∞ÈúÄË¶ÅÁöÑ‰∫∫ÔΩû</p>
                                <!-- Êñ∞Â¢ûÔºö‰∫íÂãïÊåâÈàï -->
                                <div class="flex items-center space-x-4 mt-3 pt-3 border-t border-gray-100">
                                    <button class="flex items-center space-x-1 text-gray-600 hover:text-red-500" onclick="toggleLike(this)">
                                        <i class="fa-regular fa-heart"></i>
                                        <span class="text-sm font-medium">8</span>
                                    </button>
                                    <button class="flex items-center space-x-1 text-gray-600 hover:text-blue-500" onclick="showSimpleAlert('ÁïôË®ÄÂäüËÉΩÈñãÁôº‰∏≠ÔºÅ')">
                                        <i class="fa-regular fa-comment"></i>
                                        <span class="text-sm font-medium">1</span>
                                    </button>
                                </div>
                            </div>
                            <!-- ÁØÑ‰æãË≤ºÊñá 3 -->
                            <div class="bg-white rounded-lg shadow p-4">
                                <div class="flex items-center space-x-3 mb-3">
                                    <img src="https://placehold.co/50x50/e0e7ff/4338ca?text=U" alt="Avatar" class="w-10 h-10 rounded-full">
                                    <div>
                                        <p class="font-semibold text-gray-800">UrbanExplorer22</p>
                                        <p class="text-xs text-gray-500">1 Â§©Ââç</p>
                                    </div>
                                </div>
                                <p class="text-gray-700 mb-3">ÂãüÈõÜÁöÑÂÜ¨Ë°£ÈÄÅÈÅî NPO ÂõâÔºÅÊÑüË¨ùÂ§ßÂÆ∂ÁöÑÊÑõÂøÉ ‚ù§Ô∏è</p>
                                <img src="https://placehold.co/400x250/e0e7ff/4338ca?text=Donation+Box" alt="Ë≤ºÊñáÂúñÁâá" class="w-full rounded-lg object-cover">
                                <!-- Êñ∞Â¢ûÔºö‰∫íÂãïÊåâÈàï -->
                                <div class="flex items-center space-x-4 mt-3 pt-3 border-t border-gray-100">
                                    <button class="flex items-center space-x-1 text-gray-600 hover:text-red-500" onclick="toggleLike(this)">
                                        <i class="fa-regular fa-heart"></i>
                                        <span class="text-sm font-medium">25</span>
                                    </button>
                                    <button class="flex items-center space-x-1 text-gray-600 hover:text-blue-500" onclick="showSimpleAlert('ÁïôË®ÄÂäüËÉΩÈñãÁôº‰∏≠ÔºÅ')">
                                        <i class="fa-regular fa-comment"></i>
                                        <span class="text-sm font-medium">5</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂàÜÈ†Å 2: ÊéíË°åÊ¶ú (ÂæûËàäÈ†ÅÈù¢ÁßªÂÖ•) -->
                    <div id="tab-panel-ranking" class="tab-panel p-4 space-y-4"> <!-- „Äê‰øÆÊîπ„Äëp-6 ÊîπÁÇ∫ p-4 -->
                        <!-- ÊéíÂêç 1 --><div class="bg-white rounded-lg shadow p-4 flex items-center space-x-4">
                            <span class="text-2xl font-bold text-gray-700">1</span>
                            <img src="https://placehold.co/50x50/e0e7ff/4338ca?text=U" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800">UrbanExplorer22</p>
                                <p class="text-sm text-gray-500">Â∑≤ÂÆåÊàê 15 ‰ª∂‰ªªÂãô</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-bold text-gray-800">510</p>
                                <p class="text-xs text-gray-500">Á©çÂàÜ</p>
                            </div>
                        </div>
                        
                        <!-- ÊéíÂêç 2 --><div class="bg-white rounded-lg shadow p-4 flex items-center space-x-4">
                            <span class="text-2xl font-bold text-gray-700">2</span>
                            <img src="https://placehold.co/50x50/dbeafe/1e40af?text=G" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800">GreenGuardian8</p>
                                <p class="text-sm text-gray-500">Â∑≤ÂÆåÊàê 13 ‰ª∂‰ªªÂãô</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-bold text-gray-800">420</p>
                                <p class="text-xs text-gray-500">Á©çÂàÜ</p>
                            </div>
                        </div>

                        <!-- ÊéíÂêç 3 --><div class="bg-white rounded-lg shadow p-4 flex items-center space-x-4">
                            <span class="text-2xl font-bold text-gray-700">3</span>
                            <img src="https://placehold.co/50x50/fef3c7/b45309?text=C" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800">ChanghuaHero99</p>
                                <p class="text-sm text-gray-500">Â∑≤ÂÆåÊàê 12 ‰ª∂‰ªªÂãô</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-bold text-gray-800">350</p>
                                <p class="text-xs text-gray-500">Á©çÂàÜ</p>
                            </div>
                        </div>

                        <!-- ÊéíÂêç 4 --><div class="bg-white rounded-lg shadow p-4 flex items-center space-x-4">
                            <span class="text-2xl font-bold text-gray-700">4</span>
                            <img src="https://placehold.co/50x50/fecdd3/881337?text=C" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800">CivicLover123</p>
                                <p class="text-sm text-gray-500">Â∑≤ÂÆåÊàê 8 ‰ª∂‰ªªÂãô</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-bold text-gray-800">210</p>
                                <p class="text-xs text-gray-500">Á©çÂàÜ</p>
                            </div>
                        </div>

                        <!-- ÈÄôÊòØÊÇ® --><div class="bg-white border-2 border-green-500 rounded-lg shadow-lg p-4 flex items-center space-x-4">
                            <span class="text-2xl font-bold text-green-600">5</span>
                            <img src="https://placehold.co/50x50/c6f6d5/2f855a?text=You" alt="Your Avatar" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800">NCUEfreshman (ÊÇ®)</p>
                                <p class="text-sm text-gray-500">Â∑≤ÂÆåÊàê 1 ‰ª∂‰ªªÂãô</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-bold text-green-600" id="ranking-your-points-clone">10</p> <!-- Ë§áË£Ω ID -->
                                <p class="text-xs text-gray-500">Á©çÂàÜ</p>
                            </div>
                        </div>
                        
                        <!-- ÊéíÂêç 6 --><div class="bg-white rounded-lg shadow p-4 flex items-center space-x-4">
                            <span class="text-2xl font-bold text-gray-700">6</span>
                            <img src="https://placehold.co/50x50/e5e7eb/4b5563?text=E" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800">EcoWalker77</p>
                                <p class="text-sm text-gray-500">Â∑≤ÂÆåÊàê 1 ‰ª∂‰ªªÂãô</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-bold text-gray-800">5</p>
                                <p class="text-xs text-gray-500">Á©çÂàÜ</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Â∫ïÈÉ®Â∞éËà™ (ÂÖ®Êñ∞ 5 È†ÖÁõÆÁµêÊßã) --><div class="bottom-nav w-full bg-white flex justify-around items-center border-t border-gray-200 shadow-inner-top"> <!-- ÁßªÈô§ fixed Âíå style -->
                    <!-- 1. ‰∏ªÈ†Å -->
                    <button onclick="goToPage('page-home')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-house"></i>
                        <span class="text-xs mt-1">‰∏ªÈ†Å</span>
                    </button>
                    <!-- 2. Á§æÁæ§ (Áï∂ÂâçÈ†Å) -->
                    <button onclick="goToPage('page-community-feed')" class="bottom-nav-item text-green-600">
                        <i class="fa-solid fa-users"></i>
                        <span class="text-xs font-semibold mt-1">Á§æÁæ§</span>
                    </button>
                    <!-- 3. Âú∞Âúñ -->
                    <button onclick="goToPage('page-map')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-map-location-dot"></i>
                        <span class="text-xs mt-1">Âú∞Âúñ</span>
                    </button>
                    <!-- 4. ÁçéÂãµ -->
                    <button onclick="goToPage('page-rewards')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-gift"></i>
                        <span class="text-xs mt-1">ÁçéÂãµ</span>
                    </button>
                    <!-- 5. ÂÄã‰∫∫ -->
                    <button onclick="goToPage('page-garden')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-user"></i>
                        <span class="text-xs mt-1">ÂÄã‰∫∫</span>
                    </button>
                </div>
            </div>
            
            <!-- 
                ============================================================
                Áï´Èù¢ 9: (Èö±Ëóè) Á§æÂçÄÁôºÂ∏ÉÊàêÂäü
                ============================================================
            --><div id="modal-community-success" class="page" style="display: none; background-color: rgba(0,0,0,0.5);" onclick="closeModal('modal-community-success'); goToPage('page-map');">
                <div class="m-auto bg-white rounded-lg shadow-lg p-8 w-11/12 text-center" onclick="event.stopPropagation()">
                    <i class="fa-solid fa-circle-check fa-5x text-green-500 mx-auto"></i>
                    <h2 class="text-2xl font-bold text-gray-800 mt-4">ÁôºÂ∏ÉÊàêÂäüÔºÅ</h2>
                    <p class="text-gray-600 mt-2">„ÄåÈÄ±Êú´Ê∑®ÁÅòÊ¥ªÂãï„ÄçÂ∑≤ÁôºÈÄÅÁµ¶ÈôÑËøëÁöÑÈÑ∞ÈáåËã±ÈõÑ„ÄÇ</p>
                    <button onclick="closeModal('modal-community-success'); goToPage('page-map');" class="mt-6 w-full bg-green-500 text-white font-semibold py-3 rounded-lg">
                        Â§™Â•Ω‰∫Ü
                    </button>
                </div>
            </div>

            <!-- 
                ============================================================
                Êñ∞Â¢ûÁï´Èù¢ (Home): ‰∏ªÈ†Å
                ============================================================
            --><div id="page-home" class="page bg-gray-50">
                <!-- È†ÇÈÉ®Â∞éËà™ --><div class="mini-app-header w-full p-4 flex items-center justify-between shadow-sm">
                    <h1 class="text-xl font-bold text-gray-800">‰∏ªÈ†Å</h1>
                    <button class="w-10 h-10 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center">
                        <i class="fa-solid fa-bell"></i>
                    </button>
                </div>

                <!-- ÂèØÊç≤ÂãïÂÖßÂÆπÂçÄ -->
                <div class="flex-grow overflow-y-auto p-6 space-y-6"> <!-- ÁßªÈô§ pb-16 -->
                    
                    <!-- Á∏ΩÂÆåÊàê‰ªªÂãôÂç° -->
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                        <p class="text-sm text-gray-500">ÊÇ®Á∏ΩÂÖ±ÂÆåÊàê‰∫Ü</p>
                        <p class="text-4xl font-bold text-green-600 my-2"><span id="home-tasks-completed">0</span> È†Ö‰ªªÂãô</p>
                        <p class="text-sm text-gray-600">ÊÑüË¨ùÊÇ®ÁÇ∫Á§æÂçÄÁöÑË≤¢ÁçªÔºÅ</p>
                    </div>

                    <!-- Ê¥ªÂãïÂÖ¨Âëä -->
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800 mb-3">Ê¥ªÂãïÂÖ¨Âëä</h2>
                        <div class="bg-white rounded-lg shadow p-4">
                            <img src="https://placehold.co/400x150/d1fae5/065f46?text=Weekend+Cleanup" alt="Ê¥ªÂãïÂúñÁâá" class="w-full rounded-lg object-cover mb-3">
                            <h3 class="font-bold text-gray-800">ÈÄ±Êú´Ê∑®ÁÅòËã±ÈõÑÂè¨ÈõÜ‰ª§ÔºÅ</h3>
                            <p class="text-sm text-gray-600 mt-1">Êú¨ÈÄ±Êú´Âú®ÂΩ∞ÂåñÊµ∑Êø±ÔºåÊàëÂÄëÈúÄË¶ÅÊÇ®ÁöÑÂäõÈáèÔºå‰∏ÄËµ∑ËÆìÊµ∑Â≤∏Á∑öÊõ¥ÁæéÈ∫ó„ÄÇ</p>
                        </div>
                    </div>

                    <!-- Ê∞∏‰πÖ‰ªªÂãô -->
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800 mb-3">Ê∞∏‰πÖ‰ªªÂãô</h2>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center">
                                <i class="fa-solid fa-user-group fa-lg"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800">ÈÇÄË´ãÂ§•‰º¥</h3>
                                <p class="text-sm text-gray-600">ÈÇÄË´ã‰∏Ä‰ΩçÂ•ΩÂèãÂä†ÂÖ• CivicGoÔºåÂç≥ÂèØÁç≤Âæó 20 Á©çÂàÜÔºÅ</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÈÄöÁü• -->
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800 mb-3">ÊúÄÊñ∞ÈÄöÁü•</h2>
                        <div class="bg-white rounded-lg shadow divide-y divide-gray-100">
                            <div class_id="notification-1" class="p-4 flex items-center space-x-3">
                                <i class="fa-solid fa-circle-check text-green-500 fa-lg"></i>
                                <p class="text-sm text-gray-700">ÊÇ®ÁöÑ‰ªªÂãô„ÄåÈö®ÊâãÊíøÂûÉÂúæ„ÄçÂ∑≤ÈÄöÈÅéÈ©óË≠âÔºÅÁç≤Âæó 10 ÈªûÁ©çÂàÜ„ÄÇ</p>
                            </div>
                            <div class="p-4 flex items-center space-x-3">
                                <i class="fa-solid fa-bullhorn text-blue-500 fa-lg"></i>
                                <p class="text-sm text-gray-700">„ÄåÂãüÈõÜ‰∫åÊâãÂÜ¨Ë°£„Äç‰ªªÂãôÂ∑≤Êõ¥Êñ∞Âú∞ÈªûÔºåË´ãÊü•ÁúãË©≥ÊÉÖ„ÄÇ</p>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Â∫ïÈÉ®Â∞éËà™ (ÂÖ®Êñ∞ 5 È†ÖÁõÆÁµêÊßã) --><div class="bottom-nav w-full bg-white flex justify-around items-center border-t border-gray-200 shadow-inner-top"> <!-- ÁßªÈô§ fixed Âíå style -->
                    <!-- 1. ‰∏ªÈ†Å (Áï∂ÂâçÈ†Å) -->
                    <button onclick="goToPage('page-home')" class="bottom-nav-item text-green-600">
                        <i class="fa-solid fa-house"></i>
                        <span class="text-xs font-semibold mt-1">‰∏ªÈ†Å</span>
                    </button>
                    <!-- 2. Á§æÁæ§ -->
                    <button onclick="goToPage('page-community-feed')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-users"></i>
                        <span class="text-xs mt-1">Á§æÁæ§</span>
                    </button>
                    <!-- 3. Âú∞Âúñ -->
                    <button onclick="goToPage('page-map')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-map-location-dot"></i>
                        <span class="text-xs mt-1">Âú∞Âúñ</span>
                    </button>
                    <!-- 4. ÁçéÂãµ -->
                    <button onclick="goToPage('page-rewards')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-gift"></i>
                        <span class="text-xs mt-1">ÁçéÂãµ</span>
                    </button>
                    <!-- 5. ÂÄã‰∫∫ -->
                    <button onclick="goToPage('page-garden')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-user"></i>
                        <span class="text-xs mt-1">ÂÄã‰∫∫</span>
                    </button>
                </div>
            </div>

            <!-- 
                ============================================================
                Êñ∞Â¢ûÁï´Èù¢ (Rewards): ÁçéÂãµ
                ============================================================
            --><div id="page-rewards" class="page bg-gray-50">
                <!-- È†ÇÈÉ®Â∞éËà™ --><div class="mini-app-header w-full p-4 flex items-center justify-between shadow-sm">
                    <h1 class="text-xl font-bold text-gray-800">ÁçéÂãµ</h1>
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶ -->
                </div>

                <!-- ÂèØÊç≤ÂãïÂÖßÂÆπÂçÄ -->
                <div class="flex-grow overflow-y-auto p-6 space-y-6"> <!-- ÁßªÈô§ pb-16 -->
                    
                    <!-- È°ØÁ§∫ÁõÆÂâçÁ©çÂàÜ -->
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                        <p class="text-sm text-gray-500">ÊàëÁõÆÂâçÁöÑÁ©çÂàÜ</p>
                        <p class="text-4xl font-bold text-green-600 my-2" id="rewards-current-points">0</p>
                    </div>

                    <!-- ÁçéÂãµÂÖåÊèõ (Âæû page-garden ÁßªÂÖ•) -->
                    <div class="bg-white p-6 shadow-inner-top rounded-lg"> 
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Á©çÂàÜÂÖåÊèõ</h3>
                        <div class="space-y-4">
                            <button id="redeem-line-btn-clone" onclick="redeemLinePoints(500)" class="w-full bg-[#06C755] text-white font-semibold py-3 px-4 rounded-lg flex items-center justify-between shadow transition-opacity duration-200 enabled:hover:opacity-80">
                                <span><i class="fa-brands fa-line fa-lg mr-2"></i>ÂÖåÊèõ 50 Èªû LINE POINTS</span>
                                <span class="bg-white text-green-600 text-sm font-bold px-2 py-1 rounded">500 Á©çÂàÜ</span>
                            </button>
                            <button id="redeem-coffee-btn-clone" onclick="redeemCoffeeVoucher(300)" class="w-full bg-yellow-500 text-white font-semibold py-3 px-4 rounded-lg flex items-center justify-between shadow transition-opacity duration-200 enabled:hover:opacity-80">
                                <span><i class="fa-solid fa-store mr-2"></i>ÂÖåÊèõ Âú®Âú∞ÂïÜÂÆ∂ÂíñÂï°Âà∏</span>
                                <span class="bg-white text-yellow-800 text-sm font-bold px-2 py-1 rounded">300 Á©çÂàÜ</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Â∫ïÈÉ®Â∞éËà™ (ÂÖ®Êñ∞ 5 È†ÖÁõÆÁµêÊßã) --><div class="bottom-nav w-full bg-white flex justify-around items-center border-t border-gray-200 shadow-inner-top"> <!-- ÁßªÈô§ fixed Âíå style -->
                    <!-- 1. ‰∏ªÈ†Å -->
                    <button onclick="goToPage('page-home')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-house"></i>
                        <span class="text-xs mt-1">‰∏ªÈ†Å</span>
                    </button>
                    <!-- 2. Á§æÁæ§ -->
                    <button onclick="goToPage('page-community-feed')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-users"></i>
                        <span class="text-xs mt-1">Á§æÁæ§</span>
                    </button>
                    <!-- 3. Âú∞Âúñ -->
                    <button onclick="goToPage('page-map')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-map-location-dot"></i>
                        <span class="text-xs mt-1">Âú∞Âúñ</span>
                    </button>
                    <!-- 4. ÁçéÂãµ (Áï∂ÂâçÈ†Å) -->
                    <button onclick="goToPage('page-rewards')" class="bottom-nav-item text-green-600">
                        <i class="fa-solid fa-gift"></i>
                        <span class="text-xs font-semibold mt-1">ÁçéÂãµ</span>
                    </button>
                    <!-- 5. ÂÄã‰∫∫ -->
                    <button onclick="goToPage('page-garden')" class="bottom-nav-item text-gray-500">
                        <i class="fa-solid fa-user"></i>
                        <span class="text-xs mt-1">ÂÄã‰∫∫</span>
                    </button>
                </div>
            </div>

            <!-- 
                ============================================================
                ‰øÆÊ≠£ÔºöÂÄã‰∫∫ > ÊàëÁöÑÂΩ±ÈüøÂäõ (page-impact)
                ============================================================
            --><div id="page-impact" class="page bg-gray-50">
                <div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <button onclick="goToPage('page-garden')" class="p-2 text-gray-600">
                        <i class="fa-solid fa-chevron-left fa-lg"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-grow">ÊàëÁöÑÂΩ±ÈüøÂäõ</h1>
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶ -->
                </div>
                <div class="flex-grow overflow-y-auto p-6 space-y-6">
                    <!-- Á∏ΩÂÖ±ÂÆåÊàê‰ªªÂãô -->
                    <div class="bg-white rounded-lg shadow-lg p-5 text-center">
                        <img src="https://placehold.co/100x80/dbeafe/1e3a8a?text=Task" class="mx-auto mb-3">
                        <p class="text-gray-600">ÊàëÁ∏ΩÂÖ±ÂÆåÊàê</p>
                        <p class="text-4xl font-bold text-blue-600 my-1"><span id="impact-tasks-completed">0</span> <span class="text-lg font-medium">È†Ö</span></p>
                        <p class="text-gray-800 font-semibold">‰ªªÂãô</p>
                        <p class="text-sm text-gray-500 mt-3 bg-gray-100 p-2 rounded">ÊàëÂÄëÂ∑≤‰∏ÄËµ∑ÁÇ∫Á§æÂçÄÂÆåÊàê 10,000 È†Ö‰ªªÂãô</p>
                    </div>
                    <!-- Á∏ΩÂÖ±ÊúçÂãôÊôÇÊï∏ -->
                    <div class="bg-white rounded-lg shadow-lg p-5 text-center">
                        <img src="https://placehold.co/100x80/d1fae5/047857?text=Hours" class="mx-auto mb-3">
                        <p class="text-gray-600">ÊàëÁ∏ΩÂÖ±Ë≤¢Áçª</p>
                        <p class="text-4xl font-bold text-green-600 my-1"><span id="impact-total-hours">0</span> <span class="text-lg font-medium">Â∞èÊôÇ</span></p>
                        <p class="text-gray-800 font-semibold">Á§æÂçÄÊúçÂãô</p>
                        <p class="text-sm text-gray-500 mt-3 bg-gray-100 p-2 rounded">Ëá≥‰ªäÊàëÂÄëÂ∑≤‰∏ÄËµ∑Ë≤¢Áçª 5,000 Â∞èÊôÇ</p>
                    </div>
                    <!-- Á∏ΩÂÖ±ÂãüÈõÜË≥áÊ∫ê -->
                    <div class="bg-white rounded-lg shadow-lg p-5 text-center">
                        <img src="https://placehold.co/100x80/e0e7ff/4338ca?text=Items" class="mx-auto mb-3">
                        <p class="text-gray-600">ÊàëÁ∏ΩÂÖ±ÂãüÈõÜ</p>
                        <p class="text-4xl font-bold text-gray-600 my-1"><span id="impact-total-items">0</span> <span class="text-lg font-medium">‰ª∂</span></p>
                        <p class="text-gray-800 font-semibold">Ë≥áÊ∫ê (Êõ∏Á±ç/ÂÜ¨Ë°£)</p>
                        <p class="text-sm text-gray-500 mt-3 bg-gray-100 p-2 rounded">Ëá≥‰ªäÊàëÂÄëÂ∑≤‰∏ÄËµ∑ÂãüÈõÜ 1,200 ‰ª∂Ë≥áÊ∫ê</g>
                    </div>
                    <!-- Á∏ΩÂÖ±ÈÇÄË´ã -->
                    <div class="bg-white rounded-lg shadow-lg p-5 text-center">
                        <img src="https://placehold.co/100x80/f0f9ff/0284c7?text=Invite" class="mx-auto mb-3">
                        <p class="text-gray-600">Á∏ΩÂÖ±ÈÇÄË´ã</p>
                        <p class="text-4xl font-bold text-cyan-600 my-1">0 <span class="text-lg font-medium">‰Ωç</span></p>
                        <p class="text-gray-800 font-semibold">Â§•‰º¥</p>
                    </div>
                </div>
            </div>

            <!-- 
                ============================================================
                ‰øÆÊ≠£ÔºöÂÄã‰∫∫ > Âêà‰Ωú NPO (page-partners)
                ============================================================
            --><div id="page-partners" class="page bg-gray-50"> <!-- ‰øÆÊ≠£ ID -->
                <div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <button onclick="goToPage('page-garden')" class="p-2 text-gray-600">
                        <i class="fa-solid fa-chevron-left fa-lg"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-grow">Âêà‰Ωú NPO ËàáÁ§æÂçÄ</h1> <!-- ‰øÆÊ≠£Ê®ôÈ°å -->
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶ -->
                </div>
                <div class="flex-grow overflow-y-auto p-6 space-y-4">
                    <p class="text-center text-gray-700">ÊÑüË¨ùÊâÄÊúâÂú®Âú∞Â§•‰º¥ÔºåÂÖ±ÂêåÁÇ∫Á§æÂçÄÂä™Âäõ„ÄÇ</p> <!-- ‰øÆÊ≠£ÂÖßÊñá -->
                    <div class="grid grid-cols-3 gap-4">
                        <!-- 9 ÂÄã Logo ÁØÑ‰æã -->
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=NPO+1" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=Á§æÂçÄ+A" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=NPO+2" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=NPO+3" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=Âü∫ÈáëÊúÉ" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=Á§æÂçÄ+B" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=NPO+4" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=NPO+5" alt="Logo"></div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center justify-center aspect-square"><img src="https://placehold.co/100x40/cccccc/999999?text=Á§æÂçÄ+C" alt="Logo"></div>
                    </div>
                </div>
            </div>

            <!-- 
                ============================================================
                Êñ∞Â¢ûÔºöÂÄã‰∫∫ > ÂèÉËàá CSR (page-csr)
                ============================================================
            --><div id="page-csr" class="page bg-gray-50">
                <div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <button onclick="goToPage('page-garden')" class="p-2 text-gray-600">
                        <i class="fa-solid fa-chevron-left fa-lg"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-grow">ÂèÉËàá‰ºÅÊ•≠Á§æÊúÉË≤¨‰ªª</h1>
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶ -->
                </div>
                <div class="flex-grow overflow-y-auto p-6 space-y-6">
                    <p class="text-gray-700">Â∏∂ËëóÂì°Â∑•‰∏ÄËµ∑ÂèÉËàá‰ºÅÊ•≠Á§æÊúÉË≤¨‰ªª... Ê≠°Ëøé<a href="#" class="text-blue-600">‰∫ÜËß£ÊàëÂÄëÁöÑÊúçÂãô</a>„ÄÇ</p>
                    <form onsubmit="event.preventDefault(); showSimpleAlert('Ë≥áÊñôÂ∑≤ÈÄÅÂá∫ (Ê®°Êì¨)');">
                        <div class="space-y-4">
                            <div>
                                <label for="csr-company-id" class="text-sm font-medium text-gray-700">‰ºÅÊ•≠Áµ±‰∏ÄÁ∑®ËôüÔºö</label>
                                <input type="text" id="csr-company-id" class="w-full mt-1 p-3 border border-gray-300 rounded-lg" placeholder="">
                            </div>
                            <div>
                                <label for="csr-employee-id" class="text-sm font-medium text-gray-700">Âì°Â∑•Á∑®ËôüÔºö</label>
                                <input type="text" id="csr-employee-id" class="w-full mt-1 p-3 border border-gray-300 rounded-lg" placeholder="">
                            </div>
                            <div class="flex items-center justify-between bg-gray-100 p-3 rounded-lg">
                                <span class="text-gray-700 font-medium">ÊàëÁöÑÈÇÄË´ãÁ¢º: <span class="font-bold text-lg text-black tracking-wider ml-2">B9F53A</span></span>
                                <button type="button" onclick="showSimpleAlert('Â∑≤Ë§áË£ΩÈÇÄË´ãÁ¢º B9F53A')" class="p-2 text-gray-600 hover:text-green-600">
                                    <i class="fa-solid fa-copy fa-lg"></i>
                                </button>
                            </div>
                            <button type="button" onclick="showSimpleAlert('ÂàÜ‰∫´ÈÇÄË´ãÈÄ£Áµê (Ê®°Êì¨)')" class="w-full bg-blue-500 text-white font-semibold py-3 rounded-lg shadow-lg hover:bg-blue-600 transition-colors">
                                ÂàÜ‰∫´ÈÇÄË´ãÈÄ£Áµê
                            </button>
                            <button type="submit" class="w-full bg-white border border-gray-300 text-gray-700 font-semibold py-3 rounded-lg shadow-sm hover:bg-gray-50 transition-colors">
                                Á∑®ËºØ
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- 
                ============================================================
                Êñ∞Â¢ûÔºöÂÄã‰∫∫ > ËÅØÁµ°ÊàëÂÄë (page-contact)
                ============================================================
            --><div id="page-contact" class="page bg-gray-50">
                <div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <button onclick="goToPage('page-garden')" class="p-2 text-gray-600">
                        <i class="fa-solid fa-chevron-left fa-lg"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-grow">ËÅØÁµ°ÊàëÂÄë</h1>
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶ -->
                </div>
                <div class="flex-grow overflow-y-auto p-6 space-y-6">
                    <div>
                        <h3 class="font-semibold text-gray-800">Â∏∏Ë¶ãÂïèÈ°åË™™Êòé</h3>
                        <p class="text-gray-700 mt-1">Â¶ÇÈúÄË¶ÅÂÖ∂‰ªñÂçîÂä©ÔºåË´ãÁïô‰∏ãÊÇ®ÁöÑË®äÊÅØËàáÂª∫Ë≠∞ÔºåÊàëÂÄëÂ∞áÁõ°Âø´‰ª• Email ÂõûË¶ÜÊÇ®„ÄÇË¨ùË¨ùÔºÅ</p>
                    </div>
                    <form onsubmit="event.preventDefault(); showSimpleAlert('Ë®äÊÅØÂ∑≤ÁôºÈÄÅ (Ê®°Êì¨)');">
                        <div class="space-y-4">
                            <div>
                                <label for="contact-email" class="text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="contact-email" class="w-full mt-1 p-3 border border-gray-300 rounded-lg" placeholder="">
                            </div>
                            <div>
                                <label for="contact-subject" class="text-sm font-medium text-gray-700">‰∏ªÊó®</label>
                                <input type="text" id="contact-subject" class="w-full mt-1 p-3 border border-gray-300 rounded-lg" placeholder="">
                            </div>
                            <div>
                                <label for="contact-content" class="text-sm font-medium text-gray-700">ÂÖßÂÆπ</label>
                                <textarea id="contact-content" rows="6" class="w-full mt-1 p-3 border border-gray-300 rounded-lg" placeholder=""></textarea>
                            </div>
                            <button type="submit" class="w-full bg-blue-500 text-white font-semibold py-3 rounded-lg shadow-lg hover:bg-blue-600 transition-colors">
                                ÁôºÈÄÅ
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- 
                ============================================================
                ‰øÆÊ≠£ÔºöÂÄã‰∫∫ > ÈóúÊñº (page-about)
                ============================================================
            --><div id="page-about" class="page bg-gray-50">
                <div class="mini-app-header w-full p-4 flex items-center shadow-sm">
                    <button onclick="goToPage('page-garden')" class="p-2 text-gray-600">
                        <i class="fa-solid fa-chevron-left fa-lg"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800 text-center flex-grow">ÈóúÊñº CivicGo App</h1>
                    <span class="w-10 h-10"></span> <!-- ‰Ωî‰ΩçÁ¨¶ -->
                </div>
                <div class="flex-grow overflow-y-auto p-6 space-y-6 text-center">
                    <!-- ‰øÆÊ≠£ Logo -->
                    <img src="https://placehold.co/100x100/fef08a/854d0e?text=CivicGo" class="mx-auto rounded-lg">
                    <h2 class="text-2xl font-bold text-gray-800">CivicGo</h2>
                    <p class="text-lg text-gray-600">ËÆìÊîπËÆäÔºåÂæûÂ∑∑Âè£ÈñãÂßã</p>
                    <!-- ‰øÆÊ≠£ÂÖßÊñá -->
                    <p class="text-gray-700 text-left">CivicGo ÊòØ‰∏ÄÂÄãÂª∫Á´ãÊñº LINE ÁîüÊÖãÁ≥ªÔºåÂ∞àÁÇ∫ Z ‰∏ñ‰ª£Ë®≠Ë®àÁöÑÈÅäÊà≤ÂåñÂæÆÂûãÂÖ¨Ê∞ëÂèÉËàáÂπ≥Âè∞„ÄÇ</p>
                    <p class="text-gray-700 text-left">ÊàëÂÄëÂ∞áÂÆèÂ§ßÁöÑÁ§æÊúÉÈóúÊá∑„ÄåÂæÆÁ≤íÂåñ„ÄçÁÇ∫ 10 ÂàÜÈêòÂèØÂÆåÊàêÁöÑÂú®Âú∞‰ªªÂãôÔºåÈÄèÈÅé„ÄåÂüéÂ∏ÇËä±Âúí„ÄçÁöÑÂèØË¶ñÂåñÊàêÂ∞±Á≥ªÁµ±ÔºåÂ∞áÊäΩË±°ÁöÑË≤¢ÁçªËΩâÂåñÁÇ∫ÂÖ∑È´îÁöÑÂπ∏Á¶èÊÑüËàáÊåÅÁ∫åË°åÂãïÁöÑÂÖßÂú®ÂãïÂäõ„ÄÇ</p>
                    
                    <div>
                        <p class="font-semibold">Áõ∏ÈóúÂΩ±ÁâáÔºö<a href="#" class="text-blue-600">https://youtu.be/...</a></p>
                        <p class="font-semibold">Âä†ÂÖ•ÊàëÂÄëÔºö<a href="#" class="text-blue-600">https://www.surveycake.com/...</a></p>
                    </div>

                    <button type="button" onclick="showSimpleAlert('Èö±ÁßÅÊ¨äÊ¢ùÊ¨æ (Ê®°Êì¨)')" class="w-full bg-white border border-gray-300 text-gray-700 font-semibold py-3 rounded-lg shadow-sm hover:bg-gray-50 transition-colors">
                        Èö±ÁßÅÊ¨äÊ¢ùÊ¨æ
                    </button>
                </div>
            </div>


            <!-- Ëá™ÂÆöÁæ©ÊèêÁ§∫Ê°Ü --><div id="custom-alert" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-xl p-8 w-11/12 text-center" style="display: none; z-index: 999;">
                <p id="custom-alert-message" class="text-gray-700 text-lg">Ë®äÊÅØ</p>
                <button onclick="closeSimpleAlert()" class="mt-6 w-full bg-green-500 text-white font-semibold py-2 rounded-lg">
                    Á¢∫Ë™ç
                </button>
            </div>
            <div id="alert-overlay" class="absolute inset-0 bg-black/40" style="display: none; z-index: 998;" onclick="closeSimpleAlert()"></div>

        </div> <!-- ÁµêÊùü .mobile-content --></div> <!-- ÁµêÊùü .mobile-shell --><script>
        // --- ÂÖ®ÂüüÁãÄÊÖãÁÆ°ÁêÜ (Ê®°Êì¨) ---
        let currentPoints = 0;
        let tasksCompleted = 0;
        let flowersInGarden = [];
        let trustScore = 100; 
        let acceptedTasks = []; // Êñ∞Â¢ûÔºöÂÑ≤Â≠òÂ∑≤Êé•ÂèóÁöÑ‰ªªÂãô
        let currentTaskToValidate = null; // ÂÑ≤Â≠òÁï∂ÂâçË¶ÅÈ©óË≠âÁöÑ‰ªªÂãô ID

        // --- ‰ªªÂãôË≥áÊñôÂ∫´ (Ê®°Êì¨) ---
        const taskDatabase = {
            'task1': {
                id: 'task1',
                title: 'Èö®ÊâãÊíøÂûÉÂúæ',
                type: '‰ªªÂãôÂ∞éÂêë',
                location: 'ÈÄ≤Âæ∑Ë∑ØÂÆâÂÖ®Â≥∂ (Ë∑ùÈõ¢ 50m)',
                description: 'ÂçîÂä©Ê∏ÖÁêÜË©≤ÂçÄÂüüÁöÑÂ°ëËÜ†Áì∂ËàáÁ¥ôÂ±ë„ÄÇÁí∞Â¢ÉÈúÄË¶Å‰Ω†ÊàëÂÖ±ÂêåÂÆàË≠∑ÔºÅ',
                validation: 'AI ÂúñÂÉèËæ®Ë≠ò',
                reward: 10,
                completed: false
            },
            'task2': {
                id: 'task2',
                title: 'ÊçêË¥à‰∫åÊâãÊõ∏ (7ÊàêÊñ∞)',
                type: 'Ë≥áÊ∫êÂ∞éÂêë',
                location: 'ÂΩ∞ÂåñÂ∏´Â§ßÂúñÊõ∏È§® (Ë∑ùÈõ¢ 200m)',
                description: 'ËÆìÁü•Ë≠òÊµÅÂãïÔºÅÂúñÊõ∏È§®Ê≠£ÁÇ∫ÂÅèÈÑâÂãüÈõÜÂÖíÁ´•ËÆÄÁâ©„ÄÇ',
                validation: 'Ê´ÉÂè∞‰∫∫Âì°ÊéÉÁ¢º',
                reward: 20,
                completed: false
            },
            'task3': {
                id: 'task3',
                title: 'ÂãüÈõÜ‰∫åÊâãÂÜ¨Ë°£ (NPO)',
                type: 'Á§æÂçÄÈúÄÊ±Ç',
                location: 'ÂΩ∞Â∏´Â§ßÁâπÊïôÁ≥ªËæ¶ (Ë∑ùÈõ¢ 150m)',
                description: 'ÁÇ∫Áç®Â±ÖÈï∑ËÄÖÂãüÈõÜ‰∫åÊâã‰øùÊöñÂÜ¨Ë°£ÔºåÊÇ®ÁöÑÊÑõÂøÉÊòØÂÜ¨Êó•Ë£°ÊúÄÊöñÁöÑÈôΩÂÖâ„ÄÇ',
                validation: 'ÂøóÂ∑•Á¢∫Ë™ç',
                reward: 30,
                completed: false
            }
        };

        // --- È†ÅÈù¢Â∞éËà™ ---
        let currentPage = 'page-splash';

        function goToPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.add('active');
                    if (pageId === 'page-home') {
                        updateHomeStats();
                    }
                    if (pageId === 'page-garden') {
                        updateGardenStats();
                    }
                    if (pageId === 'page-rewards') {
                        updateRewardsStats();
                    }
                    if (pageId === 'page-community-feed') { // Êõ¥Êñ∞ÔºöÊåáÂêëÊñ∞È†ÅÈù¢
                        // Êõ¥Êñ∞ÊéíË°åÊ¶úÂàÜÈ†Å‰∏≠ÁöÑÁ©çÂàÜ
                        document.getElementById('ranking-your-points-clone').innerText = currentPoints;
                    }
                    if (pageId === 'page-map') {
                        updateTaskPinsStatus(); // ÊØèÊ¨°Âà∞Âú∞ÂúñÈ†ÅÈÉΩÊõ¥Êñ∞ÂúñÈáò
                    }
                    // Êñ∞Â¢ûÔºöÊõ¥Êñ∞ÂΩ±ÈüøÂäõÈ†ÅÈù¢
                    if (pageId === 'page-impact') {
                        updateImpactStats();
                    }
                } else {
                    page.classList.remove('active');
                }
            });
            currentPage = pageId;
        }

        // --- ÂΩàÁ™ó (Modal) ÊéßÂà∂ ---
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // --- Ëá™ÂÆöÁæ©ÊèêÁ§∫Ê°Ü (Âèñ‰ª£ alert) ---
        function showSimpleAlert(message) {
            document.getElementById('custom-alert-message').innerText = message;
            document.getElementById('custom-alert').style.display = 'block';
            document.getElementById('alert-overlay').style.display = 'block';
        }
        function closeSimpleAlert() {
            document.getElementById('custom-alert').style.display = 'none';
            document.getElementById('alert-overlay').style.display = 'none';
        }
        window.alert = showSimpleAlert;


        // --- „Äê‰øÆÊîπ„ÄëÁ§æÁæ§ÂàÜÈ†ÅÂàáÊèõ (ËÜ†ÂõäÊ®£Âºè) ---
        function showTab(tabName) {
            const feedBtn = document.getElementById('tab-btn-feed');
            const rankingBtn = document.getElementById('tab-btn-ranking');
            
            if (tabName === 'feed') {
                // ÂïüÁî®ÂãïÊÖãÊåâÈàï
                feedBtn.classList.add('bg-white', 'text-green-600', 'shadow-md');
                feedBtn.classList.remove('text-gray-600');
                // Á¶ÅÁî®ÊéíË°åÊ¶úÊåâÈàï
                rankingBtn.classList.remove('bg-white', 'text-green-600', 'shadow-md');
                rankingBtn.classList.add('text-gray-600');
            } else {
                // Á¶ÅÁî®ÂãïÊÖãÊåâÈàï
                feedBtn.classList.remove('bg-white', 'text-green-600', 'shadow-md');
                feedBtn.classList.add('text-gray-600');
                // ÂïüÁî®ÊéíË°åÊ¶úÊåâÈàï
                rankingBtn.classList.add('bg-white', 'text-green-600', 'shadow-md');
                rankingBtn.classList.remove('text-gray-600');
            }
            
            // ÂàáÊèõÈù¢ÊùøÂÖßÂÆπ
            document.getElementById('tab-panel-feed').classList.toggle('active', tabName === 'feed');
            document.getElementById('tab-panel-ranking').classList.toggle('active', tabName === 'ranking');

            // Â¶ÇÊûúÂàáÊèõÂà∞ÊéíË°åÊ¶úÔºåÂà∑Êñ∞‰∏Ä‰∏ãÁ©çÂàÜ
            if (tabName === 'ranking') {
                document.getElementById('ranking-your-points-clone').innerText = currentPoints;
            }
        }
        
        // --- Êñ∞Â¢ûÔºöÁ§æÁæ§ÂãïÊÖã‰∫íÂãï ---
        
        // 1. ÁôºÂ∏ÉÊñ∞ÂãïÊÖã
        function addNewPost() {
            const contentEl = document.getElementById('new-post-content');
            const content = contentEl.value;
            if (!content.trim()) {
                showSimpleAlert("Ë´ãËº∏ÂÖ•ÂãïÊÖãÂÖßÂÆπÔºÅ");
                return;
            }
            
            const postContainer = document.getElementById('feed-post-container');
            const newPost = document.createElement('div');
            newPost.className = 'bg-white rounded-lg shadow p-4';
            
            // Ê∑®ÂåñÁî®Êà∂Ëº∏ÂÖ• (Á∞°ÊòìÁâà)
            const sanitizedContent = content.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            
            newPost.innerHTML = `
                <div class="flex items-center space-x-3 mb-3">
                    <img src="https://placehold.co/40x40/c6f6d5/2f855a?text=You" alt="Avatar" class="w-10 h-10 rounded-full">
                    <div>
                        <p class="font-semibold text-gray-800">NCUEfreshman</p>
                        <p class="text-xs text-gray-500">ÂâõÂâõ</p>
                    </div>
                </div>
                <p class="text-gray-700">${sanitizedContent}</p>
                <!-- Êñ∞Â¢ûÔºö‰∫íÂãïÊåâÈàï -->
                <div class="flex items-center space-x-4 mt-3 pt-3 border-t border-gray-100">
                    <button class="flex items-center space-x-1 text-gray-600 hover:text-red-500" onclick="toggleLike(this)">
                        <i class="fa-regular fa-heart"></i>
                        <span class="text-sm font-medium">0</span>
                    </button>
                    <button class="flex items-center space-x-1 text-gray-600 hover:text-blue-500" onclick="showSimpleAlert('ÁïôË®ÄÂäüËÉΩÈñãÁôº‰∏≠ÔºÅ')">
                        <i class="fa-regular fa-comment"></i>
                        <span class="text-sm font-medium">0</span>
                    </button>
                </div>
            `;
            
            // Â∞áÊñ∞Ë≤ºÊñáÂä†Âà∞ÊúÄ‰∏äÊñπ
            postContainer.prepend(newPost);
            
            // Ê∏ÖÁ©∫Ëº∏ÂÖ•Ê°Ü
            contentEl.value = '';
        }

        // 2. ÊåâÊÑõÂøÉ
        function toggleLike(buttonEl) {
            const icon = buttonEl.querySelector('i');
            const countSpan = buttonEl.querySelector('span');
            let count = parseInt(countSpan.innerText);
            
            if (icon.classList.contains('fa-regular')) {
                // ÊåâËÆö
                icon.classList.remove('fa-regular', 'text-gray-600');
                icon.classList.add('fa-solid', 'text-red-500');
                count++;
            } else {
                // ÂèñÊ∂àËÆö
                icon.classList.remove('fa-solid', 'text-red-500');
                icon.classList.add('fa-regular', 'text-gray-600');
                count--;
            }
            countSpan.innerText = count;
        }

        // --- Ê†∏ÂøÉÊµÅÁ®ã ---
        
        // --- Êñ∞Â¢ûÔºöÊõ¥Êñ∞‰∏ªÈ†ÅÁãÄÊÖã ---
        function updateHomeStats() {
            document.getElementById('home-tasks-completed').innerText = tasksCompleted;
        }

        // --- Êñ∞Â¢ûÔºöÊõ¥Êñ∞ÁçéÂãµÈ†ÅÁãÄÊÖã ---
        function updateRewardsStats() {
            document.getElementById('rewards-current-points').innerText = currentPoints;
        }
        
        // --- Êñ∞Â¢ûÔºöÊõ¥Êñ∞ÊàëÁöÑÂΩ±ÈüøÂäõÈ†ÅÈù¢ÁãÄÊÖã ---
        function updateImpactStats() {
            document.getElementById('impact-tasks-completed').innerText = tasksCompleted;
            // Ê®°Êì¨ÊúçÂãôÊôÇÊï∏ (ÂÅáË®≠ 1 ‰ªªÂãô = 0.25 Â∞èÊôÇ)
            document.getElementById('impact-total-hours').innerText = (tasksCompleted * 0.25).toFixed(1);
            // Ê®°Êì¨ÂãüÈõÜË≥áÊ∫ê
            let items = 0;
            if(taskDatabase['task2'].completed) items += 1; // ÂÅáË®≠Êçê 1 Êú¨Êõ∏
            if(taskDatabase['task3'].completed) items += 1; // ÂÅáË®≠Êçê 1 ‰ª∂Ë°£Êúç
            document.getElementById('impact-total-items').innerText = items;
        }

        // Êñ∞Â¢ûÔºöÊõ¥Êñ∞Âú∞Âúñ‰∏äÊâÄÊúâÂúñÈáòÁöÑÁãÄÊÖã
        function updateTaskPinsStatus() {
            Object.values(taskDatabase).forEach(task => {
                const pin = document.getElementById(`pin-${task.id}`);
                if (!pin) return;

                if (task.completed) {
                    pin.style.display = 'none'; // Èö±ËóèÂ∑≤ÂÆåÊàêÁöÑ
                } else if (acceptedTasks.includes(task.id)) {
                    pin.classList.add('active'); // Ê®ôË®òÈÄ≤Ë°å‰∏≠ (ÈñÉÁàç)
                } else {
                    pin.classList.remove('active'); // ÁßªÈô§ÈñÉÁàç
                }
            });
        }

        // 1. È°ØÁ§∫‰ªªÂãôË©≥ÊÉÖ
        function showTaskDetail(taskId) {
            const task = taskDatabase[taskId];
            if (!task || task.completed) return; // Â¶ÇÊûú‰ªªÂãô‰∏çÂ≠òÂú®ÊàñÂ∑≤ÂÆåÊàêÔºå‰∏çÈ°ØÁ§∫

            const contentEl = document.getElementById('task-detail-content');
            contentEl.innerHTML = `
                <span class="inline-block bg-green-100 text-green-700 text-xs font-semibold px-2 py-1 rounded-full mb-2">${task.type}</span>
                <h2 class="text-2xl font-bold text-gray-800">${task.title}</h2>
                <p class="text-gray-600 mt-2">${task.location}</p>
                <p class="text-gray-700 mt-4">${task.description}</p>
                <div class="mt-4 bg-gray-50 p-3 rounded-lg">
                    <p class="text-sm font-medium text-gray-700">È©óË≠âÊñπÂºèÔºö<span class="font-normal text-gray-600">${task.validation}</span></p>
                    <p class="text-sm font-medium text-gray-700 mt-1">È†êË®àÁçéÂãµÔºö<span class="font-bold text-green-600">${task.reward} Á©çÂàÜ</span></p>
                </div>
            `;
            
            const acceptBtn = document.getElementById('accept-task-btn');

            if (acceptedTasks.includes(taskId)) {
                // ÊÉÖÊ≥Å 2: Â∑≤Êé•ÂèóÔºåÈ°ØÁ§∫„ÄåÈªûÊìäÈ©óË≠â„Äç
                acceptBtn.innerText = 'ÈªûÊìäÈ©óË≠â'; 
                acceptBtn.onclick = () => goToValidationPage(taskId);
            } else {
                // ÊÉÖÊ≥Å 1: Êú™Êé•ÂèóÔºåÈ°ØÁ§∫„ÄåÊé•Âèó‰ªªÂãô„Äç
                acceptBtn.innerText = 'Êé•Âèó‰ªªÂãô'; 
                acceptBtn.onclick = () => acceptTask(taskId);
            }

            showModal('modal-task-detail');
        }

        // Ê≠•È©ü 1.5: ‰ΩøÁî®ËÄÖÊåâ‰∏ã„ÄåÊé•Âèó‰ªªÂãô„Äç
        function acceptTask(taskId) {
            if (!acceptedTasks.includes(taskId)) {
                acceptedTasks.push(taskId); // Âä†ÂÖ•Â∑≤Êé•ÂèóÂàóË°®
            }
            
            const pin = document.getElementById(`pin-${taskId}`);
            if (pin) {
                pin.classList.add('active'); // Â¢ûÂä†ÈñÉÁàçÊïàÊûú
            }

            closeModal('modal-task-detail'); // ÈóúÈñâÂΩàÁ™óÔºåÂõûÂà∞Âú∞Âúñ
        }

        // Ê≠•È©ü 1.6: ‰ΩøÁî®ËÄÖÊåâ‰∏ã„ÄåÈªûÊìäÈ©óË≠â„ÄçÔºåÊ∫ñÂÇôË∑≥ËΩâÂà∞È©óË≠âÈ†ÅÈù¢
        function goToValidationPage(taskId) {
            currentTaskToValidate = taskId; // ÂÑ≤Â≠òÁï∂Ââç‰ªªÂãôID
            const task = taskDatabase[taskId];

            // Êõ¥Êñ∞È©óË≠âÈ†ÅÈù¢ÁöÑÊèêÁ§∫ÊñáÂ≠ó
            const validationText = document.getElementById('validation-instruction');
            if (validationText) {
                if (taskId === 'task1') {
                    validationText.innerText = 'Ë´ãÊãçÊîùÊÇ®Êî∂ÈõÜÁöÑÂûÉÂúæË¢ã';
                } else if (taskId === 'task2') {
                    validationText.innerText = 'Ë´ãÊãçÊîùÊÇ®Ë¶ÅÊçêË¥àÁöÑÊõ∏Á±ç';
                } else if (taskId === 'task3') {
                    validationText.innerText = 'Ë´ãÊãçÊîùÊÇ®Ë¶ÅÊçêË¥àÁöÑÂÜ¨Ë°£';
                } else {
                    validationText.innerText = 'Ë´ãÊãçÊîù‰ªªÂãôÂÆåÊàêË≠âÊòé';
                }
            }
            
            closeModal('modal-task-detail');
            goToPage('page-validation');
        }

        // È°ØÁ§∫ AI È©óË≠âËÆÄÂèñ (ÂæûÈ©óË≠âÈ†ÅÈù¢Ëß∏Áôº)
        function startAIVerification() {
            if (!currentTaskToValidate) return; // ÂÆâÂÖ®Ê™¢Êü•

            const verifyingEl = document.getElementById('ai-verifying');
            verifyingEl.style.display = 'flex'; // È°ØÁ§∫ËÆÄÂèñÂãïÁï´

            // Ê®°Êì¨ AI È©óË≠â 2 Áßí
            setTimeout(() => {
                verifyingEl.style.display = 'none'; // Èö±ËóèËÆÄÂèñÂãïÁï´
                showValidationResult(currentTaskToValidate); // È°ØÁ§∫ÊàêÂäüÈ†ÅÈù¢
                currentTaskToValidate = null; // Ê∏ÖÈô§
            }, 2000);
        }


        // 2. È°ØÁ§∫È©óË≠âÁµêÊûú (‰ªªÂãôÊàêÂäü)
        function showValidationResult(taskId) {
            const task = taskDatabase[taskId];
            if (!task) return;

            // Êõ¥Êñ∞ÂÖ®ÂüüÁãÄÊÖã
            currentPoints += task.reward;
            tasksCompleted += 1;
            trustScore += 5; 
            flowersInGarden.push(getRandomFlower()); // ÂüéÂ∏ÇËä±ÂúíÂäüËÉΩ
            task.completed = true; // Ê®ôË®ò‰ªªÂãôÁÇ∫Â∑≤ÂÆåÊàê

            // Âæû acceptedTasks Èô£Âàó‰∏≠ÁßªÈô§
            acceptedTasks = acceptedTasks.filter(id => id !== taskId);

            // ÁßªÈô§ÂúñÈáòÁöÑÈñÉÁàçÊïàÊûú‰∏¶Èö±Ëóè
            const pin = document.getElementById(`pin-${taskId}`);
            if (pin) {
                pin.classList.remove('active');
                pin.style.display = 'none'; // Á´ãÂç≥Èö±Ëóè
            }

            document.getElementById('reward-points').innerText = task.reward;
            
            closeModal('modal-task-detail'); 
            goToPage('page-success'); 
        } 

        // 3. Êõ¥Êñ∞Ëä±ÂúíÈ†ÅÈù¢ (ÂÄã‰∫∫‰∏≠ÂøÉ)
        function updateGardenStats() {
            // Êõ¥Êñ∞Êñ∞ÁöÑÂõõÊ†ºÁµ±Ë®àÁâà
            document.getElementById('garden-total-points').innerText = currentPoints;
            document.getElementById('garden-tasks-completed').innerText = tasksCompleted;
            document.getElementById('garden-trust-score').innerText = trustScore; 
            
            // Êõ¥Êñ∞Êñ∞ÁâàÊéíË°åÊ¶ú‰∏äÁöÑÁ©çÂàÜ
            document.getElementById('ranking-your-points-clone').innerText = currentPoints;
            
            // ÂüéÂ∏ÇËä±ÂúíË¶ñË¶∫Âåñ (Âä†Âõû‰æÜ)
            const container = document.getElementById('flower-container');
            if(container) {
                container.innerHTML = ''; // Ê∏ÖÁ©∫ÔºåÈáçÊñ∞Áπ™Ë£Ω
                flowersInGarden.forEach((flowerSVG, index) => {
                    const flowerEl = document.createElement('div');
                    flowerEl.className = 'flower absolute'; // ‰ΩøÁî® absolute ÂÆö‰Ωç
                    const leftPosition = 15 + (index % 6) * 14; // Èö®Ê©üÂàÜÊï£Âú®ÂØ¨Â∫¶ÂÖß
                    const bottomPosition = 20 + (index % 3) * 15; // È´òÂ∫¶‰πüÈö®Ê©üË™øÊï¥ (Âæû 20px ~ 50px)
                    flowerEl.style.cssText = `
                        left: ${leftPosition}%; 
                        bottom: ${bottomPosition}px; 
                        transform: translateX(-50%) scale(0.5);
                    `;
                    flowerEl.innerHTML = flowerSVG;
                    container.appendChild(flowerEl);

                    setTimeout(() => {
                        flowerEl.classList.add('visible');
                        flowerEl.style.transform = `translateX(-50%) scale(1)`; // ËÆìËä±ÊúµÈï∑Â§ß
                    }, 100 * index);
                });
            }
        }
        
        // --- ÁçéÂãµÂÖåÊèõ‰∫íÂãïÂäüËÉΩ ---

        function redeemLinePoints(cost) {
            if (currentPoints >= cost) {
                // Êâ£Èô§ÈªûÊï∏
                currentPoints -= cost;
                // Êõ¥Êñ∞È°ØÁ§∫
                updateGardenStats(); // ÈÄôÊúÉÂà∑Êñ∞Ëä±ÂúíÈ†ÅÈù¢‰∏äÁöÑÊâÄÊúâÊï∏Êìö
                updateRewardsStats(); // ÂêåÊôÇÊõ¥Êñ∞ÁçéÂãµÈ†ÅÈù¢
                // È°ØÁ§∫ÊàêÂäüÊèêÁ§∫
                showSimpleAlert(`ÂÖåÊèõÊàêÂäüÔºÅÂ∑≤Ëä±Ë≤ª ${cost} Á©çÂàÜÂÖåÊèõ 50 Èªû LINE POINTS„ÄÇ`);
            } else {
                // È°ØÁ§∫Â§±ÊïóÊèêÁ§∫
                showSimpleAlert(`Á©çÂàÜ‰∏çË∂≥ÔºÅÊÇ®ÈÇÑÈúÄË¶Å ${cost - currentPoints} Á©çÂàÜÊâçËÉΩÂÖåÊèõ„ÄÇ`);
            }
        }

        function redeemCoffeeVoucher(cost) {
            if (currentPoints >= cost) {
                // Êâ£Èô§ÈªûÊï∏
                currentPoints -= cost;
                // Êõ¥Êñ∞È°ØÁ§∫
                updateGardenStats(); // ÈÄôÊúÉÂà∑Êñ∞Ëä±ÂúíÈ†ÅÈù¢‰∏äÁöÑÊâÄÊúâÊï∏Êìö
                updateRewardsStats(); // ÂêåÊôÇÊõ¥Êñ∞ÁçéÂãµÈ†ÅÈù¢
                // È°ØÁ§∫ÊàêÂäüÊèêÁ§∫
                showSimpleAlert(`ÂÖåÊèõÊàêÂäüÔºÅÂ∑≤Ëä±Ë≤ª ${cost} Á©çÂàÜÂÖåÊèõÂú®Âú∞ÂïÜÂÆ∂ÂíñÂï°Âà∏„ÄÇ`);
            } else {
                // È°ØÁ§∫Â§±ÊïóÊèêÁ§∫
                showSimpleAlert(`Á©çÂàÜ‰∏çË∂≥ÔºÅÊÇ®ÈÇÑÈúÄË¶Å ${cost - currentPoints} Á©çÂàÜÊâçËÉΩÂÖåÊèõ„ÄÇ`);
            }
        }

        // ÈáçË®≠ÊâãÂãïË°®ÂñÆ
        function resetManualForm() {
            const fields = ['task-title', 'task-description', 'task-location', 'task-time', 'task-people', 'task-reward'];
            fields.forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        function showCommunitySuccess() {
            // closeModal('modal-community-post'); // ÈÄôÈ†ÅÈù¢Â∑≤Èùû modal
            goToPage('page-map'); // ËøîÂõûÂú∞Âúñ
            showModal('modal-community-success'); // È°ØÁ§∫ÊàêÂäüÂΩàÁ™ó
            setTimeout(resetManualForm, 500); // ÈóúÈñâÊôÇÈáçË®≠Ë°®ÂñÆ
        }

        // ÂüéÂ∏ÇËä±ÂúíÂäüËÉΩ (Âä†Âõû‰æÜ)
        function getRandomFlower() {
            const colors = ['#EF4444', '#F59E0B', '#10B981', '#3B82F6', '#8B5CF6']; 
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            return `
                <svg class="w-12 h-12" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <!-- Stem --><path d="M 50 100 V 60" stroke="#10B981" stroke-width="4" />
                    <!-- Petals --><circle cx="50" cy="40" r="15" fill="${color}" opacity="0.7"/>
                    <circle cx="35" cy="50" r="15" fill="${color}" opacity="0.7"/>
                    <circle cx="65" cy="50" r="15" fill="${color}" opacity="0.7"/>
                    <circle cx="50" cy="60" r="15" fill="${color}" opacity="0.7"/>
                    <!-- Center --><circle cx="50" cy="50" r="12" fill="#FDE047"/>
                </svg>
            `;
        }

    </script>
</body>
</html>
